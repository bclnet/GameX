=== Binary Formats
TBD

==== Binary : Danae
The archive format for the Danae engine

Read Int32:: Reads an encrypted int32 from fatBytes using the provided Key
[,python]
----
include::../../../../python/gamex/families/Arkane/formats/binary.py[tag=Binary_Danae.readInt32]
----

Read String:: Reads an encrypted string from fatBytes using the provided Key
[,python]
----
include::../../../../python/gamex/families/Arkane/formats/binary.py[tag=Binary_Danae.readString]
----

Files
[cols="1,2,2,6"]
|===
|ID |Field |Type |Description

.2+|*HDR*
2+|*Header*
|

|FatOffset
|uint:4
|Fat Table Offset

.3+|*FAT*
2+|*Fat Table*
|seek:{FatOffset}

|FatSize
|uint:4
|Fat Size

|FatBytes
|bytes:{FatSize}
|Fat Bytes

.3+|*DIR*
2+|*Directory*
|

|DirPath
|string
|Directory Path (encrypted)

|NumFiles
|int:4
|Number of files (encrypted)

.6+|*FILE*
2+|*File*
|

|Path
|string
|Path (encrypted)

|Offset
|int:4
|Offset (encrypted)

|Compressed
|int:4
|Compressed type (encrypted)

|FileSize
|int:4
|File size (encrypted)

|PackedSize
|int:4
|Packed size (encrypted)
|===

[bytefield, target="Arkane_binary_danae"]
----
(draw-column-headers)
(draw-box "FatOffset" {:span 4})
(draw-gap "Data")
(draw-box "FatSize" {:span 4})
(draw-box "FatBytes" {:span 4 :borders #{:left :top :bottom}})
(draw-gap-inline)
(draw-box "eof")
(draw-bottom)
----

Read:: To read the file table:
[,python]
----
include::../../../../python/gamex/families/Arkane/formats/binary.py[tag=Binary_Danae.read]
----

ReadData:: To access a files:
[,python]
----
include::../../../../python/gamex/families/Arkane/formats/binary.py[tag=Binary_Danae.readData]
----

===== Binary: Void
The archive format for the Void engine

master.index will include other index files as subpaks

[bytefield, target="Arkane_binary_void"]
----
(draw-box "HDR" {:span 3})
(draw-box "PAK" {:span 3 :borders #{:left :top :bottom}})
(draw-gap-inline)
(draw-box "PAK" {:span 3 :borders #{:left :top :bottom}})
(draw-gap-inline)
(draw-box "...")
(draw-box "eof")
(draw-bottom)
----

[cols="1,2,2,6"]
|===
|ID |Field |Type |Description

.3+|*HDR*
2+|*Header*
|

|Magic
|uint:4
|assert: 0x04534552

|Unknown1
|uint:4
|Unknown

.5+|*PAK*
2+|*Sub Paks*
|repeat: until type == End

|Type
|uint:4
|Sub = 0x18000000, End = 0x18000000

|NameSize
|uint:4
|optional: type == Sub, Size of Name

|Path
|ascii:nameSize
|The path

|PackId
|ushort:2
|optional: not the first, Pack ID
|===

x

The normal .index files then use this file format

[cols="1,2,2,6"]
|===
|ID |Field |Type |Description

.5+|*HDR*
2+|*Header*
|

|Unknown1
|uint:4
|Unknown field.

|MainFileSize
|uint:4
|The Main file size.

|Unknown2
|byte:24
|Unknown bytes.

|NumFiles
|uint:4
|The Number of files.

.11+|*FILE*
2+|*File*
|repeat: numFiles

|Id
|uint:4
|File ID

|Tag1
|ascii:l8
|Tag1

|Tag2
|ascii:l8
|Tag2

|Path
|ascii:l8
|File path.

|Position
|ulong:8
|File position.

|FileSize
|uint:4
|File size.

|PackedSize
|uint:4
|Packed size.

|Unknown1
|uint:4
|Unknown

|Flags
|uint:4
|Flags

|Flags2
|ushort:2
|Flags2
|===
